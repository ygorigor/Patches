From 4d243081f4e4d0ae3040a0dc665ed13cbef577d4 Mon Sep 17 00:00:00 2001
From: IacobIonut01 <paulionut2003@gmail.com>
Date: Sun, 23 Oct 2022 11:26:49 +0200
Subject: [PATCH] Settings: Use ListPreference instead of DropDownPreference

Change-Id: I34c21377840ec8a298f3c49e03445151eecc3ec4
Signed-off-by: Pranav Vashi <neobuddy89@gmail.com>
---
 .../automatic_storage_management_settings.xml |  2 +-
 res/xml/zen_mode_event_rule_settings.xml      |  4 ++--
 .../AutomaticStorageManagerSettings.java      |  6 ++---
 .../zen/ZenModeEventRuleSettings.java         | 10 ++++-----
 ...arkModeScheduleSelectorControllerTest.java |  6 ++---
 .../WifiMeteredPreferenceController2Test.java | 22 +++++++++----------
 6 files changed, 25 insertions(+), 25 deletions(-)

diff --git a/res/xml/automatic_storage_management_settings.xml b/res/xml/automatic_storage_management_settings.xml
index 0c9e9b5956f..dbae54a9ab0 100644
--- a/res/xml/automatic_storage_management_settings.xml
+++ b/res/xml/automatic_storage_management_settings.xml
@@ -18,7 +18,7 @@
         xmlns:settings="http://schemas.android.com/apk/res-auto"
         android:title="@string/automatic_storage_manager_settings" >
 
-        <DropDownPreference
+        <ListPreference
             android:key="days"
             android:summary="%s"
             android:title="@string/automatic_storage_manager_days_title"
diff --git a/res/xml/zen_mode_event_rule_settings.xml b/res/xml/zen_mode_event_rule_settings.xml
index d6a0e684f14..be86f4a9950 100644
--- a/res/xml/zen_mode_event_rule_settings.xml
+++ b/res/xml/zen_mode_event_rule_settings.xml
@@ -34,13 +34,13 @@
         android:key="zen_action_buttons" />
 
     <!-- During events for -->
-    <DropDownPreference
+    <ListPreference
         android:key="calendar"
         android:title="@string/zen_mode_event_rule_calendar"
         android:summary="%s" />
 
     <!-- Where reply is -->
-    <DropDownPreference
+    <ListPreference
         android:key="reply"
         android:title="@string/zen_mode_event_rule_reply"
         android:summary="%s" />
diff --git a/src/com/android/settings/deletionhelper/AutomaticStorageManagerSettings.java b/src/com/android/settings/deletionhelper/AutomaticStorageManagerSettings.java
index a36d9edca55..133b291ea31 100644
--- a/src/com/android/settings/deletionhelper/AutomaticStorageManagerSettings.java
+++ b/src/com/android/settings/deletionhelper/AutomaticStorageManagerSettings.java
@@ -25,7 +25,7 @@ import android.view.LayoutInflater;
 import android.view.View;
 import android.view.ViewGroup;
 
-import androidx.preference.DropDownPreference;
+import androidx.preference.ListPreference;
 import androidx.preference.Preference;
 import androidx.preference.Preference.OnPreferenceChangeListener;
 
@@ -51,7 +51,7 @@ public class AutomaticStorageManagerSettings extends DashboardFragment
     private static final String KEY_DAYS = "days";
 
     private AutomaticStorageManagerSwitchBarController mSwitchController;
-    private DropDownPreference mDaysToRetain;
+    private ListPreference mDaysToRetain;
     private SettingsMainSwitchBar mSwitchBar;
 
     @Override
@@ -66,7 +66,7 @@ public class AutomaticStorageManagerSettings extends DashboardFragment
     }
 
     private void initializeDaysToRetainPreference() {
-        mDaysToRetain = (DropDownPreference) findPreference(KEY_DAYS);
+        mDaysToRetain = (ListPreference) findPreference(KEY_DAYS);
         mDaysToRetain.setOnPreferenceChangeListener(this);
 
         ContentResolver cr = getContentResolver();
diff --git a/src/com/android/settings/notification/zen/ZenModeEventRuleSettings.java b/src/com/android/settings/notification/zen/ZenModeEventRuleSettings.java
index 9b0f3fc88a6..fa243e8cf7f 100644
--- a/src/com/android/settings/notification/zen/ZenModeEventRuleSettings.java
+++ b/src/com/android/settings/notification/zen/ZenModeEventRuleSettings.java
@@ -28,7 +28,7 @@ import android.provider.Settings;
 import android.service.notification.ZenModeConfig;
 import android.service.notification.ZenModeConfig.EventInfo;
 
-import androidx.preference.DropDownPreference;
+import androidx.preference.ListPreference;
 import androidx.preference.Preference;
 import androidx.preference.Preference.OnPreferenceChangeListener;
 import androidx.preference.PreferenceScreen;
@@ -50,8 +50,8 @@ public class ZenModeEventRuleSettings extends ZenModeRuleSettingsBase {
 
     public static final String ACTION = Settings.ACTION_ZEN_MODE_EVENT_RULE_SETTINGS;
 
-    private DropDownPreference mCalendar;
-    private DropDownPreference mReply;
+    private ListPreference mCalendar;
+    private ListPreference mReply;
 
     private EventInfo mEvent;
 
@@ -128,7 +128,7 @@ public class ZenModeEventRuleSettings extends ZenModeRuleSettingsBase {
         mCreate = true;
         final PreferenceScreen root = getPreferenceScreen();
 
-        mCalendar = (DropDownPreference) root.findPreference(KEY_CALENDAR);
+        mCalendar = (ListPreference) root.findPreference(KEY_CALENDAR);
         mCalendar.setOnPreferenceChangeListener(new OnPreferenceChangeListener() {
             @Override
             public boolean onPreferenceChange(Preference preference, Object newValue) {
@@ -143,7 +143,7 @@ public class ZenModeEventRuleSettings extends ZenModeRuleSettingsBase {
             }
         });
 
-        mReply = (DropDownPreference) root.findPreference(KEY_REPLY);
+        mReply = (ListPreference) root.findPreference(KEY_REPLY);
         mReply.setEntries(new CharSequence[] {
                 getString(R.string.zen_mode_event_rule_reply_any_except_no),
                 getString(R.string.zen_mode_event_rule_reply_yes_or_maybe),
diff --git a/tests/robotests/src/com/android/settings/display/darkmode/DarkModeScheduleSelectorControllerTest.java b/tests/robotests/src/com/android/settings/display/darkmode/DarkModeScheduleSelectorControllerTest.java
index 1003d9d2ad7..44b954470d2 100644
--- a/tests/robotests/src/com/android/settings/display/darkmode/DarkModeScheduleSelectorControllerTest.java
+++ b/tests/robotests/src/com/android/settings/display/darkmode/DarkModeScheduleSelectorControllerTest.java
@@ -35,7 +35,7 @@ import android.location.Location;
 import android.location.LocationManager;
 import android.os.PowerManager;
 
-import androidx.preference.DropDownPreference;
+import androidx.preference.ListPreference;
 import androidx.preference.PreferenceScreen;
 import androidx.test.core.app.ApplicationProvider;
 
@@ -54,7 +54,7 @@ public class DarkModeScheduleSelectorControllerTest {
     private DarkModeScheduleSelectorController mController;
     private String mPreferenceKey = "key";
     @Mock
-    private DropDownPreference mPreference;
+    private ListPreference mPreference;
     @Mock
     private PreferenceScreen mScreen;
     private Context mContext;
@@ -95,7 +95,7 @@ public class DarkModeScheduleSelectorControllerTest {
                 .thenReturn("custom_bedtime");
         when(mResources.getStringArray(R.array.dark_ui_scheduler_with_bedtime_preference_titles))
                 .thenReturn(new String[]{"never", "auto", "custom", "custom_bedtime"});
-        mPreference = spy(new DropDownPreference(mContext));
+        mPreference = spy(new ListPreference(mContext));
         mPreference.setEntryValues(new CharSequence[]{"never", "auto", "custom"});
         doNothing().when(mPreference).setValueIndex(anyInt());
         when(mLocationManager.isLocationEnabled()).thenReturn(true);
diff --git a/tests/robotests/src/com/android/settings/wifi/details2/WifiMeteredPreferenceController2Test.java b/tests/robotests/src/com/android/settings/wifi/details2/WifiMeteredPreferenceController2Test.java
index c63fa60437b..58b3ea918bb 100644
--- a/tests/robotests/src/com/android/settings/wifi/details2/WifiMeteredPreferenceController2Test.java
+++ b/tests/robotests/src/com/android/settings/wifi/details2/WifiMeteredPreferenceController2Test.java
@@ -22,7 +22,7 @@ import static org.mockito.Mockito.spy;
 
 import android.content.Context;
 
-import androidx.preference.DropDownPreference;
+import androidx.preference.ListPreference;
 
 import com.android.settings.R;
 import com.android.wifitrackerlib.WifiEntry;
@@ -47,7 +47,7 @@ public class WifiMeteredPreferenceController2Test {
 
     private WifiMeteredPreferenceController2 mPreferenceController;
     private Context mContext;
-    private DropDownPreference mDropDownPreference;
+    private ListPreference mListPreference;
 
     @Before
     public void setUp() {
@@ -56,35 +56,35 @@ public class WifiMeteredPreferenceController2Test {
 
         mPreferenceController = spy(
                 new WifiMeteredPreferenceController2(mContext, mWifiEntry));
-        mDropDownPreference = new DropDownPreference(mContext);
-        mDropDownPreference.setEntries(R.array.wifi_metered_entries);
-        mDropDownPreference.setEntryValues(R.array.wifi_metered_values);
+        mListPreference = new ListPreference(mContext);
+        mListPreference.setEntries(R.array.wifi_metered_entries);
+        mListPreference.setEntryValues(R.array.wifi_metered_values);
     }
 
     @Test
     public void testUpdateState_wifiMetered_setCorrectValue() {
         doReturn(METERED_OVERRIDE_METERED).when(mPreferenceController).getMeteredOverride();
 
-        mPreferenceController.updateState(mDropDownPreference);
+        mPreferenceController.updateState(mListPreference);
 
-        assertThat(mDropDownPreference.getEntry()).isEqualTo("Treat as metered");
+        assertThat(mListPreference.getEntry()).isEqualTo("Treat as metered");
     }
 
     @Test
     public void testUpdateState_wifiNotMetered_setCorrectValue() {
         doReturn(METERED_OVERRIDE_NOT_METERED).when(mPreferenceController).getMeteredOverride();
 
-        mPreferenceController.updateState(mDropDownPreference);
+        mPreferenceController.updateState(mListPreference);
 
-        assertThat(mDropDownPreference.getEntry()).isEqualTo("Treat as unmetered");
+        assertThat(mListPreference.getEntry()).isEqualTo("Treat as unmetered");
     }
 
     @Test
     public void testUpdateState_wifiAuto_setCorrectValue() {
         doReturn(METERED_OVERRIDE_NONE).when(mPreferenceController).getMeteredOverride();
 
-        mPreferenceController.updateState(mDropDownPreference);
+        mPreferenceController.updateState(mListPreference);
 
-        assertThat(mDropDownPreference.getEntry()).isEqualTo("Detect automatically");
+        assertThat(mListPreference.getEntry()).isEqualTo("Detect automatically");
     }
 }
-- 
2.47.1.windows.1

