From fc58fa292720d2ac21afaba918ea43c1dae2908b Mon Sep 17 00:00:00 2001
From: rmp22 <195054967+rmp22@users.noreply.github.com>
Date: Wed, 25 Jun 2025 16:05:47 +0800
Subject: [PATCH] RecentsDismissUtils: fix expressive dismiss animation not
 fully dismissed

Change-Id: I0c1defa87b43bf8595144a43e64fa445d014d774
---
 .../src/com/android/quickstep/views/RecentsDismissUtils.kt     | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/quickstep/src/com/android/quickstep/views/RecentsDismissUtils.kt b/quickstep/src/com/android/quickstep/views/RecentsDismissUtils.kt
index 6acaeae8db..6153f09c37 100644
--- a/quickstep/src/com/android/quickstep/views/RecentsDismissUtils.kt
+++ b/quickstep/src/com/android/quickstep/views/RecentsDismissUtils.kt
@@ -59,6 +59,7 @@ class RecentsDismissUtils(private val recentsView: RecentsView<*, *>) {
             FloatPropertyCompat.createFloatPropertyCompat(
                 draggedTaskView.secondaryDismissTranslationProperty
             )
+        val overshootLength = 100f
         val minVelocity =
             recentsView.pagedOrientationHandler.getSecondaryDimension(draggedTaskView).toFloat()
         val startVelocity = abs(velocity).coerceAtLeast(minVelocity) * velocity.sign
@@ -68,7 +69,7 @@ class RecentsDismissUtils(private val recentsView: RecentsView<*, *>) {
                 .setSpring(createExpressiveDismissSpringForce())
                 .setStartVelocity(startVelocity)
                 .addUpdateListener { animation, value, _ ->
-                    if (isDismissing && abs(value) >= abs(dismissLength)) {
+                    if (isDismissing && abs(value) >= abs(dismissLength + overshootLength)) {
                         animation.cancel()
                     } else if (draggedTaskView.isRunningTask && recentsView.enableDrawingLiveTile) {
                         recentsView.runActionOnRemoteHandles { remoteTargetHandle ->
-- 
2.51.2.windows.1

