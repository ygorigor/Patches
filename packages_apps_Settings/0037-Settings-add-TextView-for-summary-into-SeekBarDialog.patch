From af658d58de487e7aed1a0d5bdb1a92b63bba0eda Mon Sep 17 00:00:00 2001
From: cjybyjk <cjybyjk@zjnu.edu.cn>
Date: Thu, 10 Mar 2022 23:05:20 +0800
Subject: [PATCH] Settings: add TextView for summary into
 SeekBarDialogPreference

Signed-off-by: cjybyjk <cjybyjk@zjnu.edu.cn>
Change-Id: Icff728749c3e597a4127d77646bdf3a742c35d83
Signed-off-by: Dmitrii <bankersenator@gmail.com>
Signed-off-by: Pranav Vashi <neobuddy89@gmail.com>
---
 .../preference_dialog_seekbar_material.xml      | 11 +++++++++++
 .../settings/SeekBarDialogPreference.java       | 17 +++++++++++++++++
 2 files changed, 28 insertions(+)

diff --git a/res/layout/preference_dialog_seekbar_material.xml b/res/layout/preference_dialog_seekbar_material.xml
index 09b963a8f99..e7c9132fb75 100644
--- a/res/layout/preference_dialog_seekbar_material.xml
+++ b/res/layout/preference_dialog_seekbar_material.xml
@@ -26,6 +26,17 @@
         android:layout_height="wrap_content"
         android:paddingTop="?android:attr/dialogPreferredPadding" />
 
+     <TextView
+          android:id="@+id/text"
+          android:layout_width="match_parent"
+          android:layout_height="wrap_content"
+          android:focusable="false"
+          android:paddingTop="?android:attr/dialogPreferredPadding"
+          android:paddingStart="?android:attr/dialogPreferredPadding"
+          android:paddingEnd="?android:attr/dialogPreferredPadding"
+          style="@style/TextAppearance.DialogMessage"
+          android:visibility="gone"/>
+
     <SeekBar
         android:id="@+id/seekbar"
         android:layout_width="match_parent"
diff --git a/src/com/android/settings/SeekBarDialogPreference.java b/src/com/android/settings/SeekBarDialogPreference.java
index d0c8134176b..2428035f269 100644
--- a/src/com/android/settings/SeekBarDialogPreference.java
+++ b/src/com/android/settings/SeekBarDialogPreference.java
@@ -18,12 +18,15 @@ package com.android.settings;
 
 import android.content.Context;
 import android.graphics.drawable.Drawable;
+import android.text.TextUtils;
 import android.util.AttributeSet;
 import android.view.View;
 import android.widget.ImageView;
 import android.widget.SeekBar;
+import android.widget.TextView;
 
 import com.android.settingslib.CustomDialogPreferenceCompat;
+import com.android.settings.R;
 
 /**
  * Based on frameworks/base/core/java/android/preference/SeekBarDialogPreference.java
@@ -31,6 +34,7 @@ import com.android.settingslib.CustomDialogPreferenceCompat;
  */
 public class SeekBarDialogPreference extends CustomDialogPreferenceCompat {
     private final Drawable mMyIcon;
+    private TextView mTextView;
 
     public SeekBarDialogPreference(Context context, AttributeSet attrs) {
         super(context, attrs);
@@ -64,6 +68,19 @@ public class SeekBarDialogPreference extends CustomDialogPreferenceCompat {
         } else {
             iconView.setVisibility(View.GONE);
         }
+
+        mTextView = view.findViewById(R.id.text);
+    }
+
+    public void setText(String text) {
+        if (mTextView != null) {
+            if (TextUtils.isEmpty(text)) {
+                mTextView.setVisibility(View.GONE);
+            } else {
+                mTextView.setVisibility(View.VISIBLE);
+            }
+            mTextView.setText(text);
+        }
     }
 
     protected static SeekBar getSeekBar(View dialogView) {
-- 
2.47.1.windows.1

