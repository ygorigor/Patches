From b00591b96121b1099b9e76d62bf2953d4433c896 Mon Sep 17 00:00:00 2001
From: dragonGR <alextsanisbadlorg@gmail.com>
Date: Mon, 12 Aug 2019 20:32:38 +0300
Subject: [PATCH] Settings: Address a memory leak

Change-Id: Icd72b0beef66c08a5d11e770c59eaebdb7977272
Signed-off-by: Pranav Vashi <neobuddy89@gmail.com>
---
 .../android/settings/applications/UsageAccessDetails.java   | 6 ++++++
 .../applications/appinfo/ExternalSourcesDetails.java        | 6 ++++++
 .../settings/applications/appinfo/WriteSettingsDetails.java | 6 ++++++
 3 files changed, 18 insertions(+)

diff --git a/src/com/android/settings/applications/UsageAccessDetails.java b/src/com/android/settings/applications/UsageAccessDetails.java
index e111942f751..33ab1139bbc 100644
--- a/src/com/android/settings/applications/UsageAccessDetails.java
+++ b/src/com/android/settings/applications/UsageAccessDetails.java
@@ -92,6 +92,12 @@ public class UsageAccessDetails extends AppInfoWithHeader implements OnPreferenc
                 .setPackage(mPackageName);
     }
 
+    @Override
+    public void onDestroy() {
+        super.onDestroy();
+        mUsageBridge.release();
+    }
+
     @Override
     public boolean onPreferenceClick(Preference preference) {
         return false;
diff --git a/src/com/android/settings/applications/appinfo/ExternalSourcesDetails.java b/src/com/android/settings/applications/appinfo/ExternalSourcesDetails.java
index ad1f823b48c..87103090dd9 100644
--- a/src/com/android/settings/applications/appinfo/ExternalSourcesDetails.java
+++ b/src/com/android/settings/applications/appinfo/ExternalSourcesDetails.java
@@ -65,6 +65,12 @@ public class ExternalSourcesDetails extends AppInfoWithHeader
         mSwitchPref.setOnPreferenceChangeListener(this);
     }
 
+    @Override
+    public void onDestroy() {
+        super.onDestroy();
+        mAppBridge.release();
+    }
+
     @Override
     public boolean onPreferenceChange(Preference preference, Object newValue) {
         final boolean checked = (Boolean) newValue;
diff --git a/src/com/android/settings/applications/appinfo/WriteSettingsDetails.java b/src/com/android/settings/applications/appinfo/WriteSettingsDetails.java
index 94ebc41f06c..3c82e36b243 100644
--- a/src/com/android/settings/applications/appinfo/WriteSettingsDetails.java
+++ b/src/com/android/settings/applications/appinfo/WriteSettingsDetails.java
@@ -61,6 +61,12 @@ public class WriteSettingsDetails extends AppInfoWithHeader implements OnPrefere
 
     }
 
+    @Override
+    public void onDestroy() {
+        super.onDestroy();
+        mAppBridge.release();
+    }
+
     @Override
     public boolean onPreferenceClick(Preference preference) {
         return false;
-- 
2.47.1.windows.1

