From d163c985d23078aa9c91f0fbbd6547132afd9991 Mon Sep 17 00:00:00 2001
From: Quallenauge <Hamsi2k@freenet.de>
Date: Wed, 21 Oct 2020 21:19:01 +0200
Subject: [PATCH 1/2] Add ability to enable scudo-free 32-bit libc variant.

The default value is set to enable scudo with the
32-bit libc variant.

Change-Id: I9205da12eceadfe6245763a49c7208d30b82ad99
---
 android/variable.go | 12 ++++++++++++
 1 file changed, 12 insertions(+)

diff --git a/android/variable.go b/android/variable.go
index e9ba1b34e..1b9862d18 100644
--- a/android/variable.go
+++ b/android/variable.go
@@ -75,6 +75,16 @@ type variableProperties struct {
 			Header_libs         []string `android:"arch_variant"`
 		} `android:"arch_variant"`
 
+		Malloc_low_memory_libc32 struct {
+			Cflags              []string `android:"arch_variant"`
+			Shared_libs         []string `android:"arch_variant"`
+			Whole_static_libs   []string `android:"arch_variant"`
+			Static_libs         []string `android:"arch_variant"`
+			Exclude_static_libs []string `android:"arch_variant"`
+			Srcs                []string `android:"arch_variant"`
+			Header_libs         []string `android:"arch_variant"`
+		} `android:"arch_variant"`
+
 		Malloc_zero_contents struct {
 			Cflags []string `android:"arch_variant"`
 		} `android:"arch_variant"`
@@ -290,6 +300,7 @@ type ProductVariables struct {
 	Always_use_prebuilt_sdks     *bool    `json:",omitempty"`
 	Skip_boot_jars_check         *bool    `json:",omitempty"`
 	Malloc_low_memory            *bool    `json:",omitempty"`
+	Malloc_low_memory_libc32     *bool    `json:",omitempty"`
 	Malloc_zero_contents         *bool    `json:",omitempty"`
 	Malloc_pattern_fill_contents *bool    `json:",omitempty"`
 	Safestack                    *bool    `json:",omitempty"`
@@ -768,6 +779,7 @@ func (v *ProductVariables) SetDefaultConfig() {
 		AAPTPrebuiltDPI:     []string{"xhdpi", "xxhdpi"},
 
 		Malloc_low_memory:            boolPtr(false),
+		Malloc_low_memory_libc32:     boolPtr(false),
 		Malloc_zero_contents:         boolPtr(true),
 		Malloc_pattern_fill_contents: boolPtr(false),
 		Safestack:                    boolPtr(false),
-- 

From 04d973770c9341d3ec061c5ca4564c544e654724 Mon Sep 17 00:00:00 2001
From: Pranav Vashi <neobuddy89@gmail.com>
Date: Thu, 25 Nov 2021 08:16:29 +0530
Subject: [PATCH 2/2] soong: Allow various path commands

Signed-off-by: Pranav Vashi <neobuddy89@gmail.com>
---
 ui/build/paths/config.go | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/ui/build/paths/config.go b/ui/build/paths/config.go
index 110ddee89..7914f982f 100644
--- a/ui/build/paths/config.go
+++ b/ui/build/paths/config.go
@@ -87,9 +87,11 @@ func GetConfig(name string) PathConfig {
 // run during the build. For more documentation, see path_interposer.go .
 var Configuration = map[string]PathConfig{
 	"bash":        Allowed,
+	"date":        Allowed,
 	"diff":        Allowed,
 	"dlv":         Allowed,
 	"expr":        Allowed,
+	"flock":       Allowed,
 	"fuser":       Allowed,
 	"gcert":       Allowed,
 	"gcertstatus": Allowed,
@@ -105,6 +107,7 @@ var Configuration = map[string]PathConfig{
 	"rsync":       Allowed,
 	"sh":          Allowed,
 	"stubby":      Allowed,
+	"tar":         Allowed,
 	"tr":          Allowed,
 	"unzip":       Allowed,
 	"zip":         Allowed,
-- 



